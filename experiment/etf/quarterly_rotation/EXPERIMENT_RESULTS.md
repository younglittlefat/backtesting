# 季度轮动ETF池实验结果报告

**实验日期**: 2025-12-07
**实验目的**: 验证季度更新ETF池能否提升回测收益和夏普比率

---

## 一、实验设计

### 1.1 实验对比组

| 组别 | 描述 | 标的数量 | 更新频率 |
|------|------|:--------:|:--------:|
| **轮动组** | 每季度使用过去2年数据重新评分 | 119只(并集) | 季度 |
| **固定组** | 使用2022-2023评分的ADX池 | 20只 | 不更新 |

> **数据来源**: `results/comparison/metadata.json`

### 1.2 回测参数

| 参数 | 值 | 来源 |
|------|-----|------|
| 回测期间 | 2024-01-01 ~ 2025-11-30 | `metadata.json` |
| 策略 | KAMA交叉 | `metadata.json` → `strategy_config.strategy` |
| KAMA周期 | 20 | `metadata.json` → `strategy_config.kama_period` |
| KAMA快线 | 2 | `metadata.json` → `strategy_config.kama_fast` |
| KAMA慢线 | 30 | `metadata.json` → `strategy_config.kama_slow` |
| ADX过滤器 | 启用 (周期14, 阈值25) | `metadata.json` → `strategy_config.enable_adx_filter` |
| ATR止损 | 启用 (周期14, 倍数2.5) | `metadata.json` → `strategy_config.enable_atr_stop` |
| 斜率确认 | 启用 (最少3周期) | `metadata.json` → `strategy_config.enable_slope_confirmation` |

> **配置文件**: `results/comparison/metadata.json`

### 1.3 季度轮动安排

| 季度 | 回测区间 | 评分区间 |
|------|----------|----------|
| 2024Q1 | 2024-01-01 ~ 2024-03-31 | 2022-01-01 ~ 2023-12-31 |
| 2024Q2 | 2024-04-01 ~ 2024-06-30 | 2022-04-01 ~ 2024-03-31 |
| 2024Q3 | 2024-07-01 ~ 2024-09-30 | 2022-07-01 ~ 2024-06-30 |
| 2024Q4 | 2024-10-01 ~ 2024-12-31 | 2022-10-01 ~ 2024-09-30 |
| 2025Q1 | 2025-01-01 ~ 2025-03-31 | 2023-01-01 ~ 2024-12-31 |
| 2025Q2 | 2025-04-01 ~ 2025-06-30 | 2023-04-01 ~ 2025-03-31 |
| 2025Q3 | 2025-07-01 ~ 2025-09-30 | 2023-07-01 ~ 2025-06-30 |
| 2025Q4 | 2025-10-01 ~ 2025-11-30 | 2023-10-01 ~ 2025-09-30 |

> **配置文件**: `pool_rotation_schedule.json`

---

## 二、核心结论

### **结论: 固定池表现显著优于季度轮动池**

| 指标 | 轮动组 | 固定组 | 差值 | 优胜方 |
|------|-------:|-------:|-----:|:------:|
| **夏普比率** | 0.14 | **0.42** | -0.29 | 固定组 (+200%) |
| **收益均值** | 9.62% | **12.47%** | -2.85% | 固定组 (+30%) |
| **收益中位数** | 4.08% | **9.14%** | -5.06% | 固定组 (+124%) |
| **最大回撤均值** | **-18.28%** | -19.67% | +1.39% | 轮动组 |
| **胜率** | 39.69% | **46.58%** | -6.89% | 固定组 |
| **盈亏比** | 3.41 | **3.74** | -0.33 | 固定组 |
| **MAR比率** | 0.26 | **0.32** | -0.05 | 固定组 |

> **数据来源**:
> - 轮动组: `results/comparison/rotation_overall.json`
> - 固定组: `results/comparison/static_overall.json`

---

## 三、详细数据分析

### 3.1 整体指标对比

#### 轮动组整体指标
```json
// 来源: results/comparison/rotation_overall.json
{
  "etf_count": 119,
  "sharpe_mean": 0.135,
  "sharpe_median": 0.241,
  "sharpe_std": 0.784,
  "return_mean": 9.62%,
  "return_median": 4.08%,
  "return_std": 23.35%,
  "max_dd_mean": -18.28%,
  "win_rate_mean": 39.69%,
  "trade_count_total": 693,
  "pl_ratio_mean": 3.41,
  "mar": 0.26
}
```

#### 固定组整体指标
```json
// 来源: results/comparison/static_overall.json
{
  "etf_count": 20,
  "sharpe_mean": 0.424,
  "sharpe_median": 0.536,
  "sharpe_std": 0.496,
  "return_mean": 12.47%,
  "return_median": 9.14%,
  "return_std": 16.46%,
  "max_dd_mean": -19.67%,
  "win_rate_mean": 46.58%,
  "trade_count_total": 155,
  "pl_ratio_mean": 3.74,
  "mar": 0.32
}
```

### 3.2 分季度表现对比

#### 轮动组季度表现

| 季度 | ETF数 | 夏普均值 | 收益均值 | 最大回撤 | 胜率 |
|------|:-----:|:-------:|:-------:|:-------:|:----:|
| 2024Q1 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2024Q2 | 20 | 0.05 | 5.15% | -21.10% | 34.53% |
| 2024Q3 | 20 | -0.06 | 2.32% | -20.23% | 33.18% |
| 2024Q4 | 20 | 0.23 | 7.75% | -19.66% | 44.21% |
| 2025Q1 | 20 | 0.10 | 10.92% | -22.33% | 38.74% |
| 2025Q2 | 20 | 0.05 | 13.74% | -19.32% | 38.78% |
| 2025Q3 | 20 | 0.27 | 14.71% | -11.85% | 43.02% |
| 2025Q4 | 20 | 0.30 | 14.25% | -11.51% | 45.27% |

> **数据来源**: `results/comparison/rotation_quarterly.csv`

#### 固定组季度表现

| 季度 | ETF数 | 夏普均值 | 收益均值 | 最大回撤 | 胜率 |
|------|:-----:|:-------:|:-------:|:-------:|:----:|
| 2024Q1 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2024Q2 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2024Q3 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2024Q4 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2025Q1 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2025Q2 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2025Q3 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |
| 2025Q4 | 20 | 0.42 | 12.47% | -19.67% | 46.58% |

> **数据来源**: `results/comparison/static_quarterly.csv`
> **说明**: 固定组每季度使用相同的ETF池，因此指标一致

#### 季度统计汇总

| 统计量 | 轮动组夏普 | 固定组夏普 | 轮动组收益 | 固定组收益 |
|--------|:--------:|:--------:|:--------:|:--------:|
| 均值 | 0.17 | **0.42** | 10.16% | **12.47%** |
| 标准差 | 0.16 | **0.00** | 4.52% | **0.00%** |
| 最大值 | 0.42 | 0.42 | 14.71% | 12.47% |
| 最小值 | -0.06 | 0.42 | 2.32% | 12.47% |

> **关键发现**: 轮动组夏普标准差为0.16，而固定组为0，说明**固定组表现极其稳定**

---

## 四、池子变化分析

### 4.1 季度换手统计

| 季度 | 新增 | 移除 | 重叠 | 重叠率 | 换手率 |
|------|:----:|:----:|:----:|:-----:|:------:|
| 2024Q1 | 20 | 0 | 0 | 0.0% | - |
| 2024Q2 | 16 | 16 | 4 | 20.0% | **80.0%** |
| 2024Q3 | 17 | 17 | 3 | 15.0% | **85.0%** |
| 2024Q4 | 16 | 16 | 4 | 20.0% | **80.0%** |
| 2025Q1 | 16 | 16 | 4 | 20.0% | **80.0%** |
| 2025Q2 | 7 | 7 | 13 | 65.0% | 35.0% |
| 2025Q3 | 16 | 16 | 4 | 20.0% | **80.0%** |
| 2025Q4 | 11 | 11 | 9 | 45.0% | 55.0% |

> **数据来源**: `pool_changes.json`

### 4.2 换手率统计

| 统计量 | 值 |
|--------|---:|
| 平均重叠率 | 29.3% |
| 平均换手率 | **70.7%** |
| 最高换手率 | 85.0% (2024Q3) |
| 最低换手率 | 35.0% (2025Q2) |

> **计算方法**: 换手率 = 1 - 重叠率

### 4.3 全量标的集合

轮动组在8个季度中共涉及 **119只不同的ETF**，而固定组仅使用 **20只ETF**。

> **数据来源**:
> - 轮动组标的列表: `all_rotation_etfs.csv` (119行)
> - 固定组标的列表: `../selector_score/pool_2022_2023/single_adx_score_pool_2022_2023.csv`

---

## 五、假设验证

### 5.1 原假设

| 假设 | 预期 | 实际结果 | 状态 |
|------|------|----------|:----:|
| H1: 轮动组夏普 > 固定组 | 轮动更优 | 0.14 vs 0.42 (差值 **-0.29**) | ❌ 未通过 |
| H2: 轮动组稳定性更好 | 波动更小 | 标准差 0.16 vs 0.00 | ❌ 未通过 |
| H3: 换手率可接受 (<50%) | 低换手 | 平均换手率 **70.7%** | ❌ 未通过 |

> **数据来源**:
> - H1: `rotation_overall.json` vs `static_overall.json` → `sharpe_mean`
> - H2: `rotation_quarterly.csv` → `sharpe_mean` 列标准差
> - H3: `pool_changes.json` → `overlap_ratio` 字段

### 5.2 结论解读

**三条假设均未通过**，说明季度轮动策略在当前实验设置下：
1. 风险调整收益不如固定池
2. 表现稳定性更差
3. 交易成本过高（换手率70.7%远超50%阈值）

---

## 六、原因分析

### 6.1 轮动组表现不佳的可能原因

1. **评分时滞问题**
   - 每季度使用"过去2年"数据评分
   - 历史表现未必能预测未来表现
   - 评分窗口随时间滚动可能引入噪声

2. **换手成本过高**
   - 平均每季度80%的ETF被替换
   - 即使中国ETF交易成本低（约0.05%），频繁换仓仍显著侵蚀收益
   - 8个季度共涉及119只ETF，分散度过高

3. **固定池的幸存者优势**
   - 2022-2023评分池恰好选中了在2024-2025年仍然表现良好的标的
   - 20只固定ETF展现出强大的跨周期稳健性

4. **轮动组样本稀释**
   - 轮动组119只ETF中包含大量"边缘标的"
   - 这些标的可能只在某一季度入选，整体质量参差不齐

### 6.2 数据验证

| 观察点 | 轮动组 | 固定组 | 解读 |
|--------|-------:|-------:|------|
| 标的数量 | 119 | 20 | 轮动组分散度过高 |
| 收益标准差 | 23.35% | 16.46% | 轮动组收益波动更大 |
| 总交易次数 | 693 | 155 | 轮动组交易频率是固定组4.5倍 |
| 夏普标准差 | 0.78 | 0.50 | 轮动组标的质量参差不齐 |

> **数据来源**: `rotation_overall.json`, `static_overall.json`

---

## 七、建议与后续

### 7.1 策略建议

1. **保持使用固定池**作为主策略
   - 固定池（2022-2023 ADX评分）已证明其在2024-2025年的有效性

2. **降低轮动频率**
   - 如需轮动，建议改为半年或年度更新
   - 可显著降低换手成本

3. **混合策略**
   - 核心仓位（80%）: 固定池
   - 卫星仓位（20%）: 适度轮动

### 7.2 后续实验方向

1. **延长评分周期**: 测试3年或5年评分窗口
2. **降低轮动频率**: 测试半年度/年度轮动
3. **增加换手惩罚**: 在评分中加入"在池时间"因子
4. **核心-卫星验证**: 测试固定核心+轮动卫星的混合策略

---

## 八、文件索引

### 输入文件

| 文件 | 路径 | 说明 |
|------|------|------|
| 轮动组标的 | `all_rotation_etfs.csv` | 119只ETF的并集 |
| 固定组标的 | `../selector_score/pool_2022_2023/single_adx_score_pool_2022_2023.csv` | 20只固定ETF |
| 轮动表 | `pool_rotation_schedule.json` | 8个季度的池子安排 |
| 池子变化 | `pool_changes.json` | 季度间ETF增减统计 |

### 输出文件

| 文件 | 路径 | 说明 |
|------|------|------|
| 元数据 | `results/comparison/metadata.json` | 实验配置和策略参数 |
| 轮动组整体 | `results/comparison/rotation_overall.json` | 轮动组整体统计 |
| 固定组整体 | `results/comparison/static_overall.json` | 固定组整体统计 |
| 轮动组季度 | `results/comparison/rotation_quarterly.csv` | 轮动组分季度统计 |
| 固定组季度 | `results/comparison/static_quarterly.csv` | 固定组分季度统计 |
| 分析报告 | `results/comparison/ANALYSIS_REPORT.md` | 自动生成的分析报告 |

### 回测结果目录

| 目录 | 说明 |
|------|------|
| `results/rotation/` | 轮动组回测详细结果 |
| `results/static/` | 固定组回测详细结果 |

---

## 九、复现指南

### 9.1 执行完整实验

```bash
cd /mnt/d/git/backtesting
./experiment/etf/quarterly_rotation/run_all.sh
```

### 9.2 分步执行

```bash
# 步骤1: 生成配置文件
python experiment/etf/quarterly_rotation/scripts/generate_configs.py

# 步骤2: 生成ETF池子
python experiment/etf/quarterly_rotation/scripts/generate_pools.py

# 步骤3: 运行回测
python experiment/etf/quarterly_rotation/scripts/run_backtests.py

# 步骤4: 分析结果
python experiment/etf/quarterly_rotation/scripts/analyze_results.py
```

---

*报告生成时间: 2025-12-07*
