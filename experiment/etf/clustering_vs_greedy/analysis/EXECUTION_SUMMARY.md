# 聚类 vs 贪心算法对比实验 - 执行摘要

## 实验概述

**实验目标**: 对比聚类算法和贪心算法在ETF池构建中的表现差异

**实验时间**: 2025-12-09

**实验规模**:
- 测试维度: 6个 (ADX趋势强度, 流动性, 动量12M, 价格效率, 趋势一致性, 趋势质量)
- 测试算法: 2个 (K-means聚类, 贪心选择)
- 测试市场: 2个 (熊市2022-2023, 牛市2024-2025)
- 总回测数: 24个池 (6维度 × 2算法 × 2市场)
- 每池ETF数: 20只
- 总回测次数: 480次 (24池 × 20只)

**回测策略**: KAMA自适应均线 + ADX过滤 + ATR止损 + 斜率确认

## 核心发现

### 1. 总体胜率 (按夏普比率)

| 算法 | 胜出次数 | 胜率 |
|------|---------|------|
| **贪心算法** | 7/12 | **58.3%** ✓ |
| 聚类算法 | 5/12 | 41.7% |

**结论**: 贪心算法整体表现优于聚类算法

### 2. 按市场分组表现

#### 熊市 (2022-2023)

| 算法 | 胜出次数 | 平均夏普 | 平均收益 |
|------|---------|---------|---------|
| 聚类算法 | 3/6 (50%) | -0.283 | -2.28% |
| 贪心算法 | 3/6 (50%) | -0.284 | -1.43% |

**结论**: 熊市中两种算法表现相当，平分秋色

#### 牛市 (2024-2025)

| 算法 | 胜出次数 | 平均夏普 | 平均收益 |
|------|---------|---------|---------|
| 聚类算法 | 2/6 (33.3%) | 0.035 | 5.04% |
| **贪心算法** | 4/6 (66.7%) | **0.072** | **6.31%** ✓ |

**结论**: 牛市中贪心算法优势明显，胜率达66.7%

### 3. 按维度分析

| 维度 | 聚类胜出 | 贪心胜出 | 优势算法 |
|------|---------|---------|---------|
| ADX趋势强度 | 1/2 | 1/2 | 平手 |
| **流动性** | **2/2** | 0/2 | **聚类** ✓ |
| 动量12M | 1/2 | 1/2 | 平手 |
| 价格效率 | 0/2 | 2/2 | 贪心 ✓ |
| 趋势一致性 | 1/2 | 1/2 | 平手 |
| 趋势质量 | 0/2 | 2/2 | 贪心 ✓ |

**关键洞察**:
- 聚类算法在**流动性维度**表现卓越 (100%胜率)
- 贪心算法在**价格效率**和**趋势质量**维度占优
- 其他维度两种算法表现相当

### 4. 最佳配置

#### 熊市最佳配置

| 算法 | 维度 | 夏普比率 | 年化收益 | 最大回撤 |
|------|------|---------|---------|---------|
| 聚类 | 流动性 | -0.079 | -0.23% | -20.30% |
| **贪心** | **动量12M** | **0.131** ✓ | **3.96%** ✓ | **-20.84%** |

**推荐**: 熊市使用贪心算法 + 动量12M维度

#### 牛市最佳配置

| 算法 | 维度 | 夏普比率 | 年化收益 | 最大回撤 |
|------|------|---------|---------|---------|
| 聚类 | ADX趋势强度 | 0.173 | 7.74% | -19.09% |
| **贪心** | **ADX趋势强度** | **0.424** ✓ | **12.47%** ✓ | **-19.67%** |

**推荐**: 牛市使用贪心算法 + ADX趋势强度维度

### 5. 性能差异统计

| 指标 | 平均差异 (聚类 - 贪心) | 标准差 |
|------|---------------------|--------|
| 夏普比率 | -0.017 | 0.185 |
| 年化收益 | -1.06% | 3.35% |

**解读**: 
- 平均而言，贪心算法夏普比率高0.017，收益率高1.06%
- 但差异不大，标准差较大，说明维度和市场环境影响显著

## 实验结论

### 主要结论

1. **贪心算法整体优于聚类算法** (58.3% vs 41.7%)
2. **牛市中贪心算法优势更明显** (66.7% vs 33.3%)
3. **熊市中两种算法表现相当** (50% vs 50%)
4. **聚类算法在流动性维度有独特优势** (100%胜率)

### 实践建议

#### 算法选择策略

| 场景 | 推荐算法 | 推荐维度 | 预期夏普 | 预期收益 |
|------|---------|---------|---------|---------|
| **牛市** | 贪心 | ADX趋势强度 | 0.42 | 12.5% |
| **熊市** | 贪心 | 动量12M | 0.13 | 4.0% |
| **流动性优先** | 聚类 | 流动性 | -0.03 | 0.7% |

#### 通用建议

1. **默认使用贪心算法**: 整体表现更优，实现更简单
2. **牛市优先贪心**: 牛市中贪心算法优势明显
3. **流动性场景用聚类**: 需要优化流动性时考虑聚类算法
4. **根据维度特性选择**: 不同维度适合不同算法

## 实验文件

### 生成的文件

1. **ETF池文件** (24个): `experiment/etf/clustering_vs_greedy/pools/`
   - 格式: `{dimension}_{period}_{algorithm}.csv`
   - 每个池包含20只ETF及其评分

2. **回测结果** (24个): `experiment/etf/clustering_vs_greedy/backtests/`
   - `bear_market/`: 熊市回测结果 (12个池)
   - `bull_market/`: 牛市回测结果 (12个池)

3. **分析文件**: `experiment/etf/clustering_vs_greedy/analysis/`
   - `backtest_results_summary.csv`: 完整回测结果汇总
   - `detailed_comparison.csv`: 聚类vs贪心详细对比
   - `visualization_data.json`: 可视化数据
   - `pool_generation_summary.csv`: 池生成统计

### 数据统计

- 总数据文件: 72个 (24池 × 3类文件)
- 总数据大小: ~50MB
- 回测总耗时: ~15分钟

## 技术细节

### 算法实现

**聚类算法 (K-means)**:
- 特征: 单一维度评分
- 聚类数: 3个 (高/中/低)
- 选择策略: 从高分簇中随机选择20只

**贪心算法**:
- 排序: 按单一维度评分降序
- 选择策略: 直接选择Top 20

### 回测配置

**KAMA策略参数**:
- KAMA周期: 20
- 快速常数: 2
- 慢速常数: 30

**过滤器**:
- ADX过滤: 启用 (周期14, 阈值25)
- ATR止损: 启用 (周期14, 倍数2.5)
- 斜率确认: 启用 (最小周期3)

**回测周期**:
- 熊市: 2022-01-02 ~ 2023-12-31 (2年)
- 牛市: 2024-01-02 ~ 2025-11-30 (近2年)

## 后续工作

### 建议的改进方向

1. **多维度组合**: 测试多维度加权组合的效果
2. **动态权重**: 根据市场环境动态调整维度权重
3. **混合算法**: 结合聚类和贪心的优势
4. **更多市场周期**: 扩展到更长的历史周期验证

### 待验证假设

1. 聚类算法是否在更长周期中表现更稳定？
2. 多维度组合是否能进一步提升表现？
3. 动态切换算法是否能获得更好的风险调整收益？

---

**实验执行**: Claude Code (Sonnet 4.5)  
**实验日期**: 2025-12-09  
**实验状态**: ✓ 完成
